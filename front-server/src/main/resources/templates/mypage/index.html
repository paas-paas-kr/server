<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë§ˆì´í˜ì´ì§€ - ë‹¤ë¬¸í™” ê°€ì • ìƒë‹´ ì„œë¹„ìŠ¤</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
    <!-- ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
    <nav class="top-nav">
        <div class="top-nav-content">
            <div class="top-nav-logo">
                <span class="top-nav-logo-icon">ğŸ </span>
                <span data-i18n="nav.logo">ì˜¨ê°€</span>
            </div>
            <div class="top-nav-menu">
                <a href="/home" class="top-nav-item">
                    <svg class="top-nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                        <polyline points="9 22 9 12 15 12 15 22"></polyline>
                    </svg>
                    <span data-i18n="nav.home">í™ˆ</span>
                </a>
                <a href="/chat" class="top-nav-item">
                    <svg class="top-nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg>
                    <span data-i18n="nav.chat">ì±„íŒ…</span>
                </a>
                <a href="/document" class="top-nav-item">
                    <svg class="top-nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                    </svg>
                    <span data-i18n="nav.document">ë¬¸ì„œ</span>
                </a>
                <a href="/mypage" class="top-nav-item active">
                    <svg class="top-nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                    <span data-i18n="nav.mypage">ë§ˆì´í˜ì´ì§€</span>
                </a>
            </div>
        </div>
    </nav>

    <div class="app-container with-top-nav">
        <!-- ë©”ì¸ ì»¨í…ì¸  -->
        <div class="app-content">
            <!-- ë‹¤ë¬¸í™” ê°€ì • ì•ˆë‚´ -->
            <div class="info-box">
                <h3 style="color: #92400e; font-size: 20px; font-weight: 700; margin-bottom: 12px;" data-i18n="mypage.infoTitle">ğŸŒ ë‹¤ë¬¸í™” ê°€ì •ì„ ìœ„í•œ ì¢…í•© ì§€ì› ì„œë¹„ìŠ¤</h3>
                <p style="color: #78350f; font-size: 15px; line-height: 1.7;" data-i18n="mypage.infoDesc">
                    ì–¸ì–´ì™€ ë¬¸í™”ì˜ ì°¨ì´ë¡œ ì–´ë ¤ì›€ì„ ê²ªìœ¼ì‹œëŠ” ë‹¤ë¬¸í™” ê°€ì •ì„ ìœ„í•´<br>
                    AI ìƒë‹´, ë¬¸ì„œ ìš”ì•½, ì •ë³´ ì•ˆë‚´ ë“± ë‹¤ì–‘í•œ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
                </p>
            </div>

            <!-- í”„ë¡œí•„ ì„¹ì…˜ -->
            <div class="card">
                <div class="profile-section">
                    <div class="profile-avatar-large" id="profileAvatar">ì‚¬</div>
                    <div class="profile-info-large">
                        <h2 class="profile-name" id="profileName">ì‚¬ìš©ì</h2>
                        <p class="profile-email" id="profileEmail">user@example.com</p>
                        <p class="profile-language" id="profileLanguage" style="color: var(--text-secondary); font-size: 14px; margin-top: 4px;">ì„ í˜¸ ì–¸ì–´: í•œêµ­ì–´</p>
                    </div>
                    <button class="btn btn-primary" onclick="editProfile()" style="width: auto; padding: 14px 32px;" data-i18n="mypage.editProfile">
                        í”„ë¡œí•„ ìˆ˜ì •
                    </button>
                </div>
            </div>

            <!-- ì„¤ì • ë©”ë‰´ -->
            <div class="card">
                <h2 class="card-title" data-i18n="mypage.settings">ì„¤ì •</h2>
                <div class="menu-list">
                    <a href="#" onclick="showLanguageSetting(); return false;" class="menu-item">
                        <div class="menu-item-content">
                            <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <line x1="2" y1="12" x2="22" y2="12"></line>
                                <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                            </svg>
                            <span style="font-weight: 600;" data-i18n="mypage.language">ì–¸ì–´ ì„¤ì •</span>
                        </div>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9 18 15 12 9 6"></polyline>
                        </svg>
                    </a>

                    <a href="#" onclick="showNotificationSetting(); return false;" class="menu-item">
                        <div class="menu-item-content">
                            <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                                <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                            </svg>
                            <span style="font-weight: 600;" data-i18n="mypage.notification">ì•Œë¦¼ ì„¤ì •</span>
                        </div>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9 18 15 12 9 6"></polyline>
                        </svg>
                    </a>
                </div>
            </div>

            <!-- ë„ì›€ë§ -->
            <div class="card">
                <h2 class="card-title" data-i18n="mypage.help">ë„ì›€ë§ & ì •ë³´</h2>
                <div class="menu-list">
                    <a href="#" onclick="showHelp(); return false;" class="menu-item">
                        <div class="menu-item-content">
                            <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                                <line x1="12" y1="17" x2="12.01" y2="17"></line>
                            </svg>
                            <span style="font-weight: 600;" data-i18n="mypage.guide">ì‚¬ìš© ê°€ì´ë“œ</span>
                        </div>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9 18 15 12 9 6"></polyline>
                        </svg>
                    </a>

                    <a href="#" onclick="showAbout(); return false;" class="menu-item">
                        <div class="menu-item-content">
                            <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <line x1="12" y1="16" x2="12" y2="12"></line>
                                <line x1="12" y1="8" x2="12.01" y2="8"></line>
                            </svg>
                            <span style="font-weight: 600;" data-i18n="mypage.about">ì•± ì •ë³´</span>
                        </div>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9 18 15 12 9 6"></polyline>
                        </svg>
                    </a>
                </div>
            </div>

            <!-- ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ -->
            <button class="btn btn-primary" onclick="logout()" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); box-shadow: 0 10px 30px -5px rgba(239, 68, 68, 0.3);" data-i18n="mypage.logout">
                ë¡œê·¸ì•„ì›ƒ
            </button>
        </div>
    </div>

    <!-- ì–¸ì–´ ì„¤ì • ëª¨ë‹¬ -->
    <div id="languageModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2 class="modal-title" data-i18n="mypage.language">ì–¸ì–´ ì„¤ì •</h2>
                <button class="modal-close" onclick="closeLanguageModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div style="display: flex; flex-direction: column; gap: 12px;">
                    <button class="language-option" onclick="selectLanguage('í•œêµ­ì–´')">
                        <span style="font-size: 24px; margin-right: 12px;">ğŸ‡°ğŸ‡·</span>
                        <span style="font-weight: 600;">í•œêµ­ì–´</span>
                    </button>
                    <button class="language-option" onclick="selectLanguage('English')">
                        <span style="font-size: 24px; margin-right: 12px;">ğŸ‡ºğŸ‡¸</span>
                        <span style="font-weight: 600;">English</span>
                    </button>
                    <button class="language-option" onclick="selectLanguage('ä¸­æ–‡')">
                        <span style="font-size: 24px; margin-right: 12px;">ğŸ‡¨ğŸ‡³</span>
                        <span style="font-weight: 600;">ä¸­æ–‡</span>
                    </button>
                    <button class="language-option" onclick="selectLanguage('Tiáº¿ng Viá»‡t')">
                        <span style="font-size: 24px; margin-right: 12px;">ğŸ‡»ğŸ‡³</span>
                        <span style="font-weight: 600;">Tiáº¿ng Viá»‡t</span>
                    </button>
                    <button class="language-option" onclick="selectLanguage('æ—¥æœ¬èª')">
                        <span style="font-size: 24px; margin-right: 12px;">ğŸ‡¯ğŸ‡µ</span>
                        <span style="font-weight: 600;">æ—¥æœ¬èª</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ì•Œë¦¼ ì„¤ì • ëª¨ë‹¬ -->
    <div id="notificationModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2 class="modal-title" data-i18n="mypage.notification">ì•Œë¦¼ ì„¤ì •</h2>
                <button class="modal-close" onclick="closeNotificationModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div style="padding: 20px; text-align: center;">
                    <div style="font-size: 64px; margin-bottom: 20px;" id="notificationIcon">ğŸ””</div>
                    <p style="font-size: 18px; font-weight: 600; color: var(--text-primary); margin-bottom: 12px;" id="notificationStatus">ì•Œë¦¼ì´ í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤</p>
                    <p style="color: var(--text-secondary); margin-bottom: 32px;" data-i18n="mypage.notificationDesc">ëŒ€í™” ë©”ì‹œì§€ì™€ ë¬¸ì„œ ìš”ì•½ ì™„ë£Œ ì‹œ ì•Œë¦¼ì„ ë°›ìŠµë‹ˆë‹¤</p>
                    <button class="btn btn-primary" onclick="toggleNotification()" id="notificationToggleBtn">
                        ì•Œë¦¼ ë„ê¸°
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="/js/config.js"></script>
    <script>
        // ì‚¬ìš©ì ì •ë³´ ë¡œë“œ
        function loadUserInfo() {
            const userInfo = JSON.parse(localStorage.getItem('userInfo') || '{"name": "ì‚¬ìš©ì", "email": "user@example.com", "preferredLanguage": "KOREAN"}');
            document.getElementById('profileName').textContent = userInfo.name;
            document.getElementById('profileEmail').textContent = userInfo.email;
            document.getElementById('profileAvatar').textContent = userInfo.name.charAt(0);

            // ì„ í˜¸ ì–¸ì–´ í‘œì‹œ
            if (userInfo.preferredLanguage) {
                const langMap = {
                    'KOREAN': 'í•œêµ­ì–´',
                    'ENGLISH': 'English',
                    'CHINESE': 'ä¸­æ–‡',
                    'VIETNAMESE': 'Tiáº¿ng Viá»‡t',
                    'JAPANESE': 'æ—¥æœ¬èª'
                };
                const langName = langMap[userInfo.preferredLanguage] || 'í•œêµ­ì–´';
                const preferredLanguageLabel = window.i18n ? window.i18n.translate('mypage.preferredLanguage') : 'ì„ í˜¸ ì–¸ì–´:';
                document.getElementById('profileLanguage').textContent = `${preferredLanguageLabel} ${langName}`;
            }
        }

        // í”„ë¡œí•„ í¸ì§‘
        function editProfile() {
            const currentName = document.getElementById('profileName').textContent;
            const currentEmail = document.getElementById('profileEmail').textContent;

            const namePrompt = window.i18n ? window.i18n.translate('mypage.prompt.name') : 'ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”:';
            const emailPrompt = window.i18n ? window.i18n.translate('mypage.prompt.email') : 'ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”:';
            const successMsg = window.i18n ? window.i18n.translate('mypage.profileUpdated') : 'âœ… í”„ë¡œí•„ì´ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.';

            const newName = prompt(namePrompt, currentName);
            if (newName === null || newName.trim() === '') return;

            const newEmail = prompt(emailPrompt, currentEmail);
            if (newEmail === null || newEmail.trim() === '') return;

            const userInfo = {
                name: newName.trim(),
                email: newEmail.trim()
            };

            localStorage.setItem('userInfo', JSON.stringify(userInfo));
            loadUserInfo();
            alert(successMsg);
        }

        // ì–¸ì–´ ì„¤ì • ëª¨ë‹¬ ì—´ê¸°
        function showLanguageSetting() {
            document.getElementById('languageModal').classList.add('open');
        }

        // ì–¸ì–´ ì„¤ì • ëª¨ë‹¬ ë‹«ê¸°
        function closeLanguageModal() {
            document.getElementById('languageModal').classList.remove('open');
        }

        // ì–¸ì–´ ì„ íƒ
        async function selectLanguage(language) {
            // ì–¸ì–´ ì½”ë“œ ë§¤í•‘
            const languageMap = {
                'í•œêµ­ì–´': 'KOREAN',
                'English': 'ENGLISH',
                'ä¸­æ–‡': 'CHINESE',
                'Tiáº¿ng Viá»‡t': 'VIETNAMESE',
                'æ—¥æœ¬èª': 'JAPANESE'
            };
            const langEnum = languageMap[language] || 'KOREAN';

            try {
                console.log('ğŸŒ ì–¸ì–´ ë³€ê²½ ìš”ì²­:', langEnum);

                // ì„œë²„ì— ì–¸ì–´ ì„¤ì • ë³€ê²½ ìš”ì²­
                const response = await fetch(`${window.API_BASE_URL}/api/auth/language`, {
                    method: 'PATCH',
                    headers: window.getAuthHeaders(),
                    body: JSON.stringify({
                        preferredLanguage: langEnum
                    }),
                    credentials: 'include'
                });

                console.log('ğŸ“¥ ì‘ë‹µ ìƒíƒœ:', response.status);

                if (response.ok) {
                    const result = await response.json();
                    console.log('âœ… ì–¸ì–´ ë³€ê²½ ì„±ê³µ:', result);

                    // ìƒˆë¡œìš´ JWT í† í° ì €ì¥
                    if (result.data && result.data.accessToken) {
                        localStorage.setItem('accessToken', result.data.accessToken);
                        console.log('âœ… ìƒˆë¡œìš´ JWT í† í° ì €ì¥ ì™„ë£Œ');
                    }

                    // ì‚¬ìš©ì ì •ë³´ ì—…ë°ì´íŠ¸
                    const userInfo = JSON.parse(localStorage.getItem('userInfo') || '{}');
                    userInfo.preferredLanguage = langEnum;
                    localStorage.setItem('userInfo', JSON.stringify(userInfo));

                    // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ë„ ì €ì¥
                    localStorage.setItem('language', language);
                    closeLanguageModal();

                    // í˜ì´ì§€ UI ì–¸ì–´ ë³€ê²½
                    if (window.i18n) {
                        window.i18n.updatePageLanguage();
                    }

                    // í”„ë¡œí•„ ì •ë³´ ë‹¤ì‹œ ë¡œë“œ
                    loadUserInfo();

                    const successMsg = window.i18n ? window.i18n.translate('mypage.languageChanged').replace('{0}', language) : `âœ… ì–¸ì–´ê°€ "${language}"ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.\nLanguage changed to "${language}".`;
                    alert(successMsg);
                } else {
                    const errorText = await response.text();
                    console.error('âŒ ì–¸ì–´ ë³€ê²½ ì‹¤íŒ¨:', response.status, errorText);
                    const errorMsg = window.i18n ? window.i18n.translate('mypage.languageChangeFailed').replace('{0}', response.status).replace('{1}', errorText) : `ì–¸ì–´ ì„¤ì • ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\nìƒíƒœ: ${response.status}\nì˜¤ë¥˜: ${errorText}`;
                    alert(errorMsg);
                }
            } catch (error) {
                console.error('âŒ Language update error:', error);
                const errorMsg = window.i18n ? window.i18n.translate('mypage.languageChangeError').replace('{0}', error.message) : `ì–¸ì–´ ì„¤ì • ë³€ê²½ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\nì˜¤ë¥˜: ${error.message}`;
                alert(errorMsg);
            }
        }

        // ì•Œë¦¼ ì„¤ì • ëª¨ë‹¬ ì—´ê¸°
        function showNotificationSetting() {
            const enabled = localStorage.getItem('notifications') !== 'false';
            const enabledText = window.i18n ? window.i18n.translate('mypage.notificationEnabled') : 'ì•Œë¦¼ì´ í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤';
            const disabledText = window.i18n ? window.i18n.translate('mypage.notificationDisabled') : 'ì•Œë¦¼ì´ ë¹„í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤';
            const turnOffText = window.i18n ? window.i18n.translate('mypage.notificationTurnOff') : 'ì•Œë¦¼ ë„ê¸°';
            const turnOnText = window.i18n ? window.i18n.translate('mypage.notificationTurnOn') : 'ì•Œë¦¼ ì¼œê¸°';

            document.getElementById('notificationIcon').textContent = enabled ? 'ğŸ””' : 'ğŸ”•';
            document.getElementById('notificationStatus').textContent = enabled ? enabledText : disabledText;
            document.getElementById('notificationToggleBtn').textContent = enabled ? turnOffText : turnOnText;
            document.getElementById('notificationModal').classList.add('open');
        }

        // ì•Œë¦¼ ì„¤ì • ëª¨ë‹¬ ë‹«ê¸°
        function closeNotificationModal() {
            document.getElementById('notificationModal').classList.remove('open');
        }

        // ì•Œë¦¼ í† ê¸€
        function toggleNotification() {
            const enabled = localStorage.getItem('notifications') !== 'false';
            const disabledMsg = window.i18n ? window.i18n.translate('mypage.notificationDisabledMsg') : 'ğŸ”• ì•Œë¦¼ì´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.';
            const enabledMsg = window.i18n ? window.i18n.translate('mypage.notificationEnabledMsg') : 'ğŸ”” ì•Œë¦¼ì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.';
            localStorage.setItem('notifications', enabled ? 'false' : 'true');
            closeNotificationModal();
            alert(enabled ? disabledMsg : enabledMsg);
        }

        // ë„ì›€ë§ ëª¨ë‹¬
        function showHelp() {
            const guideTitle = window.i18n ? window.i18n.translate('mypage.guide') : 'ì‚¬ìš© ê°€ì´ë“œ';
            const chatTitle = window.i18n ? window.i18n.translate('mypage.help.chat.title') : 'ğŸ’¬ QnA ì±—ë´‡';
            const chatItem1 = window.i18n ? window.i18n.translate('mypage.help.chat.item1') : 'AIì™€ ì‹¤ì‹œê°„ìœ¼ë¡œ ëŒ€í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤';
            const chatItem2 = window.i18n ? window.i18n.translate('mypage.help.chat.item2') : 'ì›í•˜ëŠ” ì–¸ì–´ë¥¼ ì„ íƒí•˜ì—¬ ë‹µë³€ì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤';
            const chatItem3 = window.i18n ? window.i18n.translate('mypage.help.chat.item3') : 'ìŒì„± íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì—¬ ì§ˆë¬¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤';
            const docTitle = window.i18n ? window.i18n.translate('mypage.help.document.title') : 'ğŸ“„ ë¬¸ì„œ';
            const docItem1 = window.i18n ? window.i18n.translate('mypage.help.document.item1') : 'PDF ë˜ëŠ” ì´ë¯¸ì§€ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ë©´ AIê°€ ìë™ìœ¼ë¡œ ìš”ì•½í•´ì¤ë‹ˆë‹¤';
            const docItem2 = window.i18n ? window.i18n.translate('mypage.help.document.item2') : 'ë“œë˜ê·¸ ì•¤ ë“œë¡­ìœ¼ë¡œ ê°„í¸í•˜ê²Œ ì—…ë¡œë“œí•˜ì„¸ìš”';
            const docItem3 = window.i18n ? window.i18n.translate('mypage.help.document.item3') : 'ìµœëŒ€ 10MBê¹Œì§€ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤';
            const mypageTitle = window.i18n ? window.i18n.translate('mypage.help.mypage.title') : 'ğŸ‘¤ ë§ˆì´í˜ì´ì§€';
            const mypageItem1 = window.i18n ? window.i18n.translate('mypage.help.mypage.item1') : 'í”„ë¡œí•„ê³¼ ì„¤ì •ì„ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤';
            const mypageItem2 = window.i18n ? window.i18n.translate('mypage.help.mypage.item2') : 'ì–¸ì–´ ì„¤ì •ì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤';
            const mypageItem3 = window.i18n ? window.i18n.translate('mypage.help.mypage.item3') : 'ì•Œë¦¼ ì„¤ì •ì„ ì¡°ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤';
            const footer = window.i18n ? window.i18n.translate('mypage.help.footer') : 'ğŸ’¡ ì¶”ê°€ ì§ˆë¬¸ì´ ìˆìœ¼ì‹œë©´ QnA ì±—ë´‡ì„ í†µí•´ ë¬¸ì˜í•´ì£¼ì„¸ìš”!';

            const modal = document.createElement('div');
            modal.className = 'modal open';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 600px;">
                    <div class="modal-header">
                        <h2 class="modal-title">ğŸ“– ${guideTitle}</h2>
                        <button class="modal-close" onclick="this.closest('.modal').remove()">&times;</button>
                    </div>
                    <div class="modal-body" style="text-align: left;">
                        <div style="margin-bottom: 24px;">
                            <h3 style="color: #f59e0b; font-size: 18px; font-weight: 700; margin-bottom: 12px;">
                                ${chatTitle}
                            </h3>
                            <ul style="color: #1f2937; font-size: 15px; line-height: 1.8; margin-left: 20px;">
                                <li>${chatItem1}</li>
                                <li>${chatItem2}</li>
                                <li>${chatItem3}</li>
                            </ul>
                        </div>

                        <div style="margin-bottom: 24px;">
                            <h3 style="color: #f59e0b; font-size: 18px; font-weight: 700; margin-bottom: 12px;">
                                ${docTitle}
                            </h3>
                            <ul style="color: #1f2937; font-size: 15px; line-height: 1.8; margin-left: 20px;">
                                <li>${docItem1}</li>
                                <li>${docItem2}</li>
                                <li>${docItem3}</li>
                            </ul>
                        </div>

                        <div style="margin-bottom: 24px;">
                            <h3 style="color: #f59e0b; font-size: 18px; font-weight: 700; margin-bottom: 12px;">
                                ${mypageTitle}
                            </h3>
                            <ul style="color: #1f2937; font-size: 15px; line-height: 1.8; margin-left: 20px;">
                                <li>${mypageItem1}</li>
                                <li>${mypageItem2}</li>
                                <li>${mypageItem3}</li>
                            </ul>
                        </div>

                        <div style="padding: 16px; background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border-radius: 12px; border: 2px solid #fbbf24;">
                            <p style="color: #92400e; font-size: 14px; font-weight: 600;">${footer}</p>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // ì•± ì •ë³´ ëª¨ë‹¬
        function showAbout() {
            const aboutTitle = window.i18n ? window.i18n.translate('mypage.about') : 'ì•± ì •ë³´';
            const appName = window.i18n ? window.i18n.translate('mypage.about.appName') : 'ì˜¨ê°€';
            const description = window.i18n ? window.i18n.translate('mypage.about.description') : 'AI ê¸°ë°˜ ë‹¤ë¬¸í™” ê°€ì • ì •ë³´ ì¥ë²½ í•´ì†Œ í”Œë«í¼';
            const detail1 = window.i18n ? window.i18n.translate('mypage.about.detail1') : 'ë‹¤ë¬¸í™” ê°€ì •ì„ ìœ„í•œ AI ê¸°ë°˜ QnA ì±—ë´‡ ë° ë¬¸ì„œ ì§€ì› ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.';
            const detail2 = window.i18n ? window.i18n.translate('mypage.about.detail2') : 'ì–¸ì–´ì™€ ë¬¸í™”ì˜ ì¥ë²½ì„ ë„˜ì–´ ëª¨ë“  ê°€ì •ì´ í•„ìš”í•œ ì •ë³´ì™€ ë„ì›€ì„ ì‰½ê²Œ ë°›ì„ ìˆ˜ ìˆë„ë¡ ë•ê³  ìˆìŠµë‹ˆë‹¤.';
            const version = window.i18n ? window.i18n.translate('mypage.about.version') : 'ë²„ì „: 1.0.0';
            const developer = window.i18n ? window.i18n.translate('mypage.about.developer') : 'ê°œë°œ: PaaSPaaS Team';
            const copyright = window.i18n ? window.i18n.translate('mypage.about.copyright') : 'Â© 2025 All rights reserved.';

            const modal = document.createElement('div');
            modal.className = 'modal open';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 500px;">
                    <div class="modal-header">
                        <h2 class="modal-title">â„¹ï¸ ${aboutTitle}</h2>
                        <button class="modal-close" onclick="this.closest('.modal').remove()">&times;</button>
                    </div>
                    <div class="modal-body" style="text-align: center;">
                        <div style="font-size: 64px; margin-bottom: 20px;">ğŸ </div>
                        <h2 style="font-size: 28px; font-weight: 700; color: #1f2937; margin-bottom: 12px;">${appName}</h2>
                        <p style="font-size: 16px; color: #6b7280; margin-bottom: 32px;">${description}</p>

                        <div style="text-align: left; background: #f9fafb; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                            <p style="font-size: 15px; color: #1f2937; line-height: 1.7; margin-bottom: 12px;">
                                ${detail1}
                            </p>
                            <p style="font-size: 15px; color: #1f2937; line-height: 1.7;">
                                ${detail2}
                            </p>
                        </div>

                        <div style="padding: 12px; background: white; border: 1px solid #e5e7eb; border-radius: 8px;">
                            <p style="font-size: 14px; color: #6b7280; margin-bottom: 8px;">${version}</p>
                            <p style="font-size: 14px; color: #6b7280; margin-bottom: 8px;">${developer}</p>
                            <p style="font-size: 12px; color: #9ca3af;">${copyright}</p>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // ë¡œê·¸ì•„ì›ƒ
        async function logout() {
            const confirmMsg = getLogoutMessage('confirm');
            if (confirm(confirmMsg)) {
                try {
                    const response = await fetch(`${window.API_BASE_URL}/api/auth/logout`, {
                        method: 'POST',
                        headers: window.getAuthHeaders(),
                        credentials: 'include'
                    });

                    // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì •ë¦¬
                    localStorage.removeItem('isLoggedIn');
                    localStorage.removeItem('userInfo');
                    localStorage.removeItem('accessToken');

                    const successMsg = getLogoutMessage('success');
                    alert(successMsg);
                    window.location.href = '/auth/login';
                } catch (error) {
                    console.error('Logout error:', error);
                    // ì—ëŸ¬ê°€ ë°œìƒí•´ë„ ë¡œì»¬ ì •ë¦¬ í›„ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™
                    localStorage.removeItem('isLoggedIn');
                    localStorage.removeItem('userInfo');
                    localStorage.removeItem('accessToken');
                    window.location.href = '/auth/login';
                }
            }
        }

        // ë¡œê·¸ì•„ì›ƒ ë©”ì‹œì§€ ë‹¤êµ­ì–´ ì²˜ë¦¬
        function getLogoutMessage(type) {
            const messages = {
                'confirm': {
                    'KOREAN': 'ë¡œê·¸ì•„ì›ƒí•˜ì‹œê² ìŠµë‹ˆê¹Œ?',
                    'ENGLISH': 'Do you want to logout?',
                    'VIETNAMESE': 'Báº¡n cÃ³ muá»‘n Ä‘Äƒng xuáº¥t?',
                    'CHINESE': 'ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ',
                    'JAPANESE': 'ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ã¾ã™ã‹ï¼Ÿ'
                },
                'success': {
                    'KOREAN': 'âœ… ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤.',
                    'ENGLISH': 'âœ… Logged out successfully.',
                    'VIETNAMESE': 'âœ… ÄÄƒng xuáº¥t thÃ nh cÃ´ng.',
                    'CHINESE': 'âœ… é€€å‡ºç™»å½•æˆåŠŸã€‚',
                    'JAPANESE': 'âœ… ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸã€‚'
                }
            };

            const lang = window.i18n ? window.i18n.getLanguageCode(window.i18n.getCurrentLanguage()) : 'KOREAN';
            return messages[type]?.[lang] || messages[type]?.['KOREAN'] || '';
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì •ë³´ ë¡œë“œ
        document.addEventListener('DOMContentLoaded', function() {
            loadUserInfo();
        });
    </script>

    <script src="/js/i18n.js"></script>
    <script>
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë¡œê·¸ì¸ ì²´í¬ ë° ì–¸ì–´ ì ìš©
        document.addEventListener('DOMContentLoaded', function() {
            // ë¡œê·¸ì¸ ì²´í¬
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            if (!isLoggedIn || isLoggedIn !== 'true') {
                window.location.href = '/auth/login';
                return;
            }

            // ì–¸ì–´ ì ìš©
            if (window.i18n) {
                window.i18n.updatePageLanguage();
            }
        });
    </script>
</body>
</html>
